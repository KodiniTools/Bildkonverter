import{r as C,B as c,C as l,M as T,H as s,L as y,R as m,y as d,F as V,G as P,P as _,O as R,K as u,I as E}from"./vendor.BZFRd1Xx.js";import{_ as N,u as U,e as q}from"./index.CIh8EjgO.js";import{useGalleryStore as H}from"./galleryStore.Bi-gAqB3.js";const K={class:"gallery-view"},W={class:"gallery-header"},O={class:"gallery-subtitle"},Z={class:"actions-bar"},J={class:"left-actions"},Q=["title"],X={key:1,class:"image-count"},Y={key:0,class:"right-actions"},j={key:0,class:"empty-state"},x={key:1,class:"gallery-grid"},ee=["onClick"],te={class:"thumbnail-wrapper"},le=["src","alt"],ne={class:"selection-indicator"},se=["onClick","title"],ae={class:"image-info"},ie=["title"],oe={class:"image-meta"},re={class:"image-date"},de={class:"preview-image-container"},ue=["src","alt"],ce={class:"preview-info"},me={class:"preview-meta"},ge={class:"preview-actions"},fe={__name:"GalleryView",setup(he){const{t:g}=U(),w=q(),a=H(),b=C(null),r=C(null);function D(){var e;(e=b.value)==null||e.click()}async function $(e){const t=Array.from(e.target.files);if(t.length!==0){console.log(`Lade ${t.length} Datei(en) hoch...`);for(const n of t)try{await B(n)}catch(i){console.error(`Fehler beim Laden von ${n.name}:`,i),alert(g("gallery.uploadError",{name:n.name})+": "+i.message)}e.target.value=""}}async function B(e){return new Promise((t,n)=>{if(!e.type.startsWith("image/")){n(new Error("Datei ist kein Bild"));return}if(e.size>50*1024*1024){n(new Error("Datei zu groß (max. 50MB)"));return}const i=new FileReader;i.onload=h=>{const o=new Image;o.onload=()=>{const f=F(o,300,300),p={id:Date.now()+Math.random(),name:e.name,url:h.target.result,thumbnail:f,width:o.width,height:o.height,size:e.size,uploadedAt:new Date,file:e};a.addImage(p),t(p)},o.onerror=()=>{n(new Error("Fehler beim Laden des Bildes"))},o.src=h.target.result},i.onerror=()=>{n(new Error("Fehler beim Lesen der Datei"))},i.readAsDataURL(e)})}function F(e,t,n){const i=document.createElement("canvas"),h=i.getContext("2d");let o=e.width,f=e.height;const p=Math.min(t/o,n/f);return o*=p,f*=p,i.width=o,i.height=f,h.drawImage(e,0,0,o,f),i.toDataURL("image/jpeg",.8)}function M(e){r.value=e}function v(){r.value=null}async function z(){const e=a.selectedImage();if(e)try{await w.push({path:"/editor",query:{galleryImageId:e.id}}),console.log("✅ Navigation zum Editor")}catch(t){console.error("Fehler beim Öffnen im Editor:",t),alert("Fehler beim Öffnen im Editor: "+t.message)}}async function A(){if(r.value)try{await w.push({path:"/editor",query:{galleryImageId:r.value.id}}),v()}catch(e){console.error("Fehler beim Öffnen im Editor:",e),alert("Fehler beim Öffnen im Editor: "+e.message)}}function L(){const e=a.selectedImage();!e||!confirm(g("gallery.confirmDelete",{name:e.name}))||a.removeImage(e.id)}function S(){const e=a.images.length;if(e===0)return;const t=g(e===1?"gallery.imageCount.single":"gallery.imageCount.plural"),n=g("gallery.confirmDeleteAll",{count:e,images:t});if(!confirm(n))return;a.images.map(o=>o.id).forEach(o=>{a.removeImage(o)}),console.log(g("gallery.deleteSuccess",{count:e,images:t}))}function G(e){const t=document.createElement("a");t.href=e.url,t.download=e.name,t.click()}function I(e){if(e===0)return"0 Bytes";const t=1024,n=["Bytes","KB","MB"],i=Math.floor(Math.log(e)/Math.log(t));return Math.round(e/Math.pow(t,i)*100)/100+" "+n[i]}function k(e){return new Intl.DateTimeFormat("de-DE",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(e)}return(e,t)=>(u(),c("div",K,[l("header",W,[l("h1",null,s(e.$t("gallery.title","Galerie")),1),l("p",O,s(e.$t("gallery.subtitle","Verwalten Sie Ihre Bilder")),1)]),l("div",Z,[l("div",J,[l("button",{class:"btn btn-primary",onClick:D},[t[2]||(t[2]=l("i",{class:"fas fa-upload"},null,-1)),m(" "+s(e.$t("gallery.buttons.upload")),1)]),l("input",{ref_key:"fileInput",ref:b,type:"file",accept:"image/*",multiple:"",onChange:$,style:{display:"none"}},null,544),d(a).images.length>0?(u(),c("button",{key:0,class:"btn btn-danger-outline",onClick:S,title:e.$t("gallery.tooltips.deleteAll")},[t[3]||(t[3]=l("i",{class:"fas fa-trash-alt"},null,-1)),m(" "+s(e.$t("gallery.buttons.deleteAll")),1)],8,Q)):y("",!0),d(a).images.length>0?(u(),c("span",X,s(d(a).images.length)+" "+s(d(a).images.length===1?e.$t("gallery.imageCount.single"):e.$t("gallery.imageCount.plural")),1)):y("",!0)]),d(a).selectedImage()?(u(),c("div",Y,[l("button",{class:"btn btn-success",onClick:z},[t[4]||(t[4]=l("i",{class:"fas fa-edit"},null,-1)),m(" "+s(e.$t("gallery.buttons.addToEditor")),1)]),l("button",{class:"btn btn-danger",onClick:L},[t[5]||(t[5]=l("i",{class:"fas fa-trash"},null,-1)),m(" "+s(e.$t("gallery.buttons.delete")),1)])])):y("",!0)]),d(a).images.length===0?(u(),c("div",j,[t[6]||(t[6]=l("i",{class:"fas fa-images"},null,-1)),l("h3",null,s(e.$t("gallery.empty.title")),1),l("p",null,s(e.$t("gallery.empty.description")),1)])):(u(),c("div",x,[(u(!0),c(V,null,P(d(a).images,n=>(u(),c("div",{key:n.id,class:E(["gallery-item",{selected:d(a).selectedImageId===n.id}]),onClick:i=>d(a).selectImage(n.id)},[l("div",te,[l("img",{src:n.thumbnail,alt:n.name,class:"thumbnail"},null,8,le),l("div",ne,[l("i",{class:E(["fas",d(a).selectedImageId===n.id?"fa-check-circle":"fa-circle"])},null,2)]),l("button",{class:"preview-btn",onClick:_(i=>M(n),["stop"]),title:e.$t("gallery.buttons.preview")},[...t[7]||(t[7]=[l("i",{class:"fas fa-search-plus"},null,-1)])],8,se)]),l("div",ae,[l("div",{class:"image-name",title:n.name},s(n.name),9,ie),l("div",oe,[l("span",null,s(n.width)+" × "+s(n.height)+"px",1),l("span",null,s(I(n.size)),1)]),l("div",re,s(k(n.uploadedAt)),1)])],10,ee))),128))])),(u(),T(R,{to:"body"},[r.value?(u(),c("div",{key:0,class:"preview-overlay",onClick:v},[l("div",{class:"preview-content",onClick:t[1]||(t[1]=_(()=>{},["stop"]))},[l("button",{class:"preview-close",onClick:v},[...t[8]||(t[8]=[l("i",{class:"fas fa-times"},null,-1)])]),l("div",de,[l("img",{src:r.value.url,alt:r.value.name},null,8,ue)]),l("div",ce,[l("h3",null,s(r.value.name),1),l("div",me,[l("span",null,[t[9]||(t[9]=l("i",{class:"fas fa-ruler-combined"},null,-1)),m(" "+s(r.value.width)+" × "+s(r.value.height)+"px",1)]),l("span",null,[t[10]||(t[10]=l("i",{class:"fas fa-file"},null,-1)),m(" "+s(I(r.value.size)),1)]),l("span",null,[t[11]||(t[11]=l("i",{class:"fas fa-calendar"},null,-1)),m(" "+s(k(r.value.uploadedAt)),1)])])]),l("div",ge,[l("button",{class:"btn btn-success",onClick:A},[...t[12]||(t[12]=[l("i",{class:"fas fa-edit"},null,-1),m(" Zum Editor hinzufügen ",-1)])]),l("button",{class:"btn btn-secondary",onClick:t[0]||(t[0]=n=>G(r.value))},[...t[13]||(t[13]=[l("i",{class:"fas fa-download"},null,-1),m(" Herunterladen ",-1)])])])])])):y("",!0)]))]))}},we=N(fe,[["__scopeId","data-v-36a04f98"]]);export{we as default};
